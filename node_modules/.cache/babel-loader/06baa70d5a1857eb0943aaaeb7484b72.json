{"ast":null,"code":"import _slicedToArray from\"D:/reactutorial/React-Router/01-starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from\"axios\";import{useEffect,useState}from\"react\";import{storage}from\"./fire\";import Showdata from\"./Showdata\";import{database}from\"./fire\";import firebase from\"firebase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Fileupload(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),progress=_useState2[0],setProgress=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),post=_useState4[0],setPost=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),baseUrl=_useState6[0],setBaseUrl=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),toggle=_useState8[0],setToggle=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),info=_useState10[0],setInfo=_useState10[1];var fileReader;var handleFileRead=function handleFileRead(e){var content=[JSON.parse(fileReader.result)];console.log(content);console.log(typeof content);setPost(content[0]);console.log(content[0][0].title);content[0].map(writeUserData);function writeUserData(item){var postListRef=firebase.database().ref('posts');var newPostRef=postListRef.push();newPostRef.set({item:item});};};var formHandler=function formHandler(e){e.preventDefault();var file=e.target[0].files[0];console.log(file);handleFileChosen(file);uploadFiles(file);};var uploadFiles=function uploadFiles(file){//\nvar uploadTask=storage.ref(\"files/\".concat(file.name)).put(file);uploadTask.on(\"state_changed\",function(snapshot){//\nvar prog=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgress(prog);},function(error){return console.log(error);},function(){storage.ref(\"files\").child(file.name).getDownloadURL().then(function(url){console.log(url);});});};var handleFileChosen=function handleFileChosen(file){fileReader=new FileReader();fileReader.onloadend=handleFileRead;fileReader.readAsText(file);};// function view(baseurl){\n//        console.log(baseUrl);\n//        axios.get(baseUrl).then((response) => {\n//         setPost(response.data);\n//       })\n//     }   \nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"Fileupload\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:formHandler,children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",className:\"input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Upload\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Uploading done \",progress,\"%\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{style:{color:'red',fontSize:'15px'},children:progress===100?\"click here to view the data\":\"Waiting\"}),progress===100&&/*#__PURE__*/_jsx(\"button\",{style:{marginBottom:'10px',marginLeft:'5px'},onClick:function onClick(){return setToggle(true);},children:\"View data\"}),toggle&&/*#__PURE__*/_jsx(Showdata,{data:post})]});}export default Fileupload;","map":{"version":3,"sources":["D:/reactutorial/React-Router/01-starting-project/src/Fileupload.js"],"names":["axios","useEffect","useState","storage","Showdata","database","firebase","Fileupload","progress","setProgress","post","setPost","baseUrl","setBaseUrl","toggle","setToggle","info","setInfo","fileReader","handleFileRead","e","content","JSON","parse","result","console","log","title","map","writeUserData","item","postListRef","ref","newPostRef","push","set","formHandler","preventDefault","file","target","files","handleFileChosen","uploadFiles","uploadTask","name","put","on","snapshot","prog","Math","round","bytesTransferred","totalBytes","error","child","getDownloadURL","then","url","FileReader","onloadend","readAsText","color","fontSize","marginBottom","marginLeft"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { storage } from \"./fire\";\r\nimport Showdata from \"./Showdata\";\r\nimport { database } from \"./fire\";\r\nimport firebase from \"firebase\";\r\n\r\nfunction Fileupload() {\r\n    \r\n  \r\n  const [progress, setProgress] = useState(0);\r\n  const [post, setPost] = useState([]);\r\n  const[baseUrl,setBaseUrl]=useState('');\r\n  const[toggle,setToggle]=useState(false);\r\n  const [info , setInfo] = useState([]);\r\n\r\n  let fileReader;\r\n    \r\n  const handleFileRead = (e) => {\r\n    const content =[JSON.parse(fileReader.result)];\r\n    console.log(content);\r\n    console.log(typeof(content));\r\n    setPost(content[0])\r\n    console.log((content[0][0]).title);\r\n       content[0].map(writeUserData);\r\n\r\n       function writeUserData(item) {\r\n        var postListRef = firebase.database().ref('posts');\r\n  var newPostRef = postListRef.push();\r\n  newPostRef.set({    \r\n      item  });\r\n      };\r\n \r\n    \r\n      \r\n  };\r\n\r\n\r\n  const formHandler = (e) => {\r\n    e.preventDefault();\r\n    const file = e.target[0].files[0];\r\n    console.log(file);\r\n    handleFileChosen(file);\r\n    uploadFiles(file);\r\n  };\r\n \r\n\r\n\r\n\r\n  const uploadFiles = (file) => {\r\n    //\r\n    const uploadTask = storage.ref(`files/${file.name}`).put(file);\r\n    uploadTask.on(\r\n      \"state_changed\",\r\n      (snapshot) => {\r\n        //\r\n        const prog = Math.round(\r\n          (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n        );\r\n        setProgress(prog);\r\n      },\r\n      (error) => console.log(error),\r\n      () => {\r\n        storage\r\n          .ref(\"files\")\r\n          .child(file.name)\r\n          .getDownloadURL()\r\n          .then((url) => {\r\n            console.log(url)          \r\n                   \r\n          })          \r\n            \r\n          });\r\n      }\r\n    \r\n      const handleFileChosen = (file) => {\r\n        fileReader = new FileReader();\r\n        fileReader.onloadend = handleFileRead;\r\n        fileReader.readAsText(file);\r\n      };\r\n  \r\n\r\n\r\n// function view(baseurl){\r\n//        console.log(baseUrl);\r\n//        axios.get(baseUrl).then((response) => {\r\n//         setPost(response.data);\r\n\r\n//       })\r\n//     }   \r\n     \r\n            \r\n\r\n\r\n  return (\r\n    <div className=\"Fileupload\">\r\n      <form onSubmit={formHandler}>\r\n        <input type=\"file\" className=\"input\" />\r\n        <button type=\"submit\">Upload</button>\r\n      </form>\r\n      <hr />\r\n     \r\n      <p>Uploading done {progress}%</p><br></br>\r\n      <span style={{color:'red',fontSize:'15px'}}>{progress===100?\"click here to view the data\":\"Waiting\"\r\n          }</span>\r\n          {progress===100 && <button style={{marginBottom:'10px' ,marginLeft:'5px'}}onClick={()=>setToggle(true)}>View data</button>}\r\n          {toggle && <Showdata data={post}/>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Fileupload;"]},"metadata":{},"sourceType":"module"}